# Make Concrete

## 概要

Make Concreteノードは、データを具体的（Concrete）にし、必要に応じてポイントに変換します。暗黙的なデータ型（Surface、Volumeなど）を明示的なポイントデータに変換し、非空間データは破棄されます。

## 機能詳細

このノードは、入力データを「具体化（Concrete化）」します。暗黙的な空間データ（サーフェス、ボリューム、スプラインなど）をサンプリングして、明示的なポイントデータに変換します。

### 処理フロー

1. **入力データの取得**: 任意の型のデータを入力から取得
2. **空間データの判定**: データが空間データかどうかを確認
3. **具体化**: 暗黙的なデータをサンプリングしてポイントに変換
4. **非空間データの破棄**: 空間データでないものは除外
5. **ポイントデータの出力**: 具体化されたポイントデータを出力

### 具体化（Concrete化）とは

- **暗黙的データ**: サーフェス、ボリューム、スプライン（ポイントを直接持たない）
- **明示的データ**: ポイントデータ（実際のポイント配列を持つ）

Make Concreteは、暗黙的データをデフォルト設定でサンプリングし、明示的なポイントデータに変換します。

## プロパティ

### bPassThroughEmptyAttributeSets
- **型**: `bool`
- **デフォルト値**: `false`
- **オーバーライド可能**: いいえ（レガシー設定）
- **説明**: バージョン5.6より前の動作を保持するための設定
  - `false`: 空のAttributeSetも変換する（5.6以降のデフォルト）
  - `true`: 空のAttributeSetを変換せずにパススルー（5.6より前の動作）
- **注意**: レガシー互換性のための内部設定

## 使用例

### 基本的な具体化

```
Get Landscape Data (暗黙的なサーフェス)
  → Make Concrete
  → (明示的なポイントデータとして出力)
```

### サンプリング前の具体化

```
Get Volume Data
  → Make Concrete (デフォルト設定でサンプリング)
  → Attribute Transform Op (ポイントに対して処理)
```

### 暗黙的データの確認

```
Union (複数の暗黙的データを結合)
  → Make Concrete
  → Debug (実際のポイント数を確認)
```

### 典型的な用途

- **データの具体化**: 暗黙的なデータを明示的なポイントに変換
- **サンプリングの強制**: デフォルト設定でのサンプリングを強制実行
- **ポイント数の確認**: 暗黙的データから実際に生成されるポイント数を確認
- **ポイント操作の準備**: ポイントレベルの操作を行う前の準備
- **非空間データのフィルタリング**: 空間データのみを残して他を除外

## 実装の詳細

### クラス構成

```cpp
// 設定クラス
class UPCGMakeConcreteSettings : public UPCGSettings

// 実行エレメント
class FPCGMakeConcreteElement : public IPCGElement
```

### ピン構成

**入力ピン**:
- デフォルトの入力ピン（任意の型）

**出力ピン**:
- デフォルトのポイント出力ピン
- 空間データのみが出力され、非空間データは破棄

### 実行ループモード

- **Mode**: `EPCGElementExecutionLoopMode::SinglePrimaryPin`
- 各入力データに対して個別に具体化を実行

### ベースポイントデータサポート

- **サポート**: はい (`SupportsBasePointDataInputs = true`)
- AttributeSet、Surface、Volumeなどの暗黙的なポイントデータに対応

### CRC計算

- `ShouldComputeFullOutputDataCrc = true`
- スプライン/ランドスケープなどの外部データをサンプリングする可能性があるため、完全なCRCを計算
- 変更の伝播や再実行を停止できる可能性を考慮

### サンプリング

暗黙的データは、デフォルト設定でサンプリングされます:
- **Surface**: デフォルトのサーフェスサンプリング設定
- **Volume**: デフォルトのボリュームサンプリング設定
- **Spline**: デフォルトのスプラインサンプリング設定

### ノード表示

- `ShouldDrawNodeCompact() = true`
- エディタでコンパクト表示される
- `CanUserEditTitle() = false`
- ユーザーはタイトルを編集できない

### パフォーマンス考慮事項

- **サンプリングコスト**: 大きな暗黙的データの具体化は計算コストが高い
- **デフォルト設定**: サンプリングはデフォルト設定で行われるため、カスタマイズ不可
- **ポイント数**: 出力ポイント数は、元のデータサイズとデフォルトサンプリング設定に依存

## 注意事項

1. **デフォルトサンプリング**: サンプリングパラメータはカスタマイズできません
2. **非空間データの破棄**: 空間データでない入力は出力から除外されます
3. **既にポイントのデータ**: 既にポイントデータの場合はそのまま出力
4. **CRC計算**: 外部データ参照により、完全なCRCが計算されます
5. **コンパクト表示**: ノードはエディタで小さく表示されます

## Make Concrete vs To Point

- **Make Concrete**:
  - データを具体化し、必要に応じてポイントに変換
  - デフォルトサンプリング設定を使用
  - 非空間データを破棄

- **To Point**:
  - すべての入力をポイントデータに変換
  - 必要に応じてデフォルトサンプリング
  - より広範な変換をサポート

Make Concreteは、空間データのみを扱い、それらを具体的なポイントに変換する場合に使用します。

## 関連ノード

- **To Point**: 入力をポイントデータに変換
- **Attribute Set To Point**: AttributeSetをポイントデータに変換
- **Surface Sampler**: サーフェスのカスタムサンプリング
- **Volume Sampler**: ボリュームのカスタムサンプリング
- **Spline Sampler**: スプラインのカスタムサンプリング

## 実装ファイル

- **ヘッダー**: `Engine/Plugins/PCG/Source/PCG/Public/Elements/PCGMakeConcreteElement.h`
- **実装**: `Engine/Plugins/PCG/Source/PCG/Private/Elements/PCGMakeConcreteElement.cpp`
- **カテゴリ**: Spatial
