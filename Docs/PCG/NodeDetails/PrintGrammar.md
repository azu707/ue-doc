# Print Grammar

## 概要
Print Grammarノードは、グラマー（文法）を解釈し、その結果を出力します。L-SystemやPCG Grammarシステムと統合されており、生成的な文字列処理を実行できます。

- **ノードタイプ**: Debug
- **クラス**: `UPCGPrintGrammarSettings`
- **エレメント**: `FPCGPrintGrammarElement`

## 機能詳細
このノードは、定義されたグラマールールに基づいて文字列を生成または変換し、結果を出力します。プロシージャルな構造やパターンの生成に使用できます。

### 主な機能
- **グラマー解釈**: 定義されたグラマールールを処理
- **文字列生成**: グラマーに基づいて文字列を生成
- **デバッグ出力**: 解釈結果をログに出力
- **L-System対応**: L-Systemスタイルのグラマーをサポート

### 処理フロー
1. グラマー文字列を取得
2. グラマーパーサーで解釈
3. ルールを適用して結果を生成
4. 結果を出力ピンに転送
5. 結果をログに出力（デバッグ）

## プロパティ

### Grammar
- **型**: FString
- **カテゴリ**: Settings
- **アクセス**: BlueprintReadWrite, EditAnywhere
- **メタ**: MultiLine, PCG_Overridable
- **説明**: 解釈するグラマー。複数行の文字列として定義できます

## 使用例

### 基本的なL-Systemグラマー
```
// シンプルなL-Systemルール
Grammar: |
  axiom: A
  A -> AB
  B -> A
イテレーション: 3
結果: A -> AB -> ABA -> ABAAB
```

### 分岐構造の生成
```
// 木の分岐パターンを生成
Grammar: |
  axiom: X
  X -> F[+X][-X]FX
  F -> FF
結果: プロシージャルな分岐構造
```

### 建物レイアウトの生成
```
// 建物の部屋配置パターン
Grammar: |
  axiom: R
  R -> R+R+R+R
  + -> rotate90
結果: 正方形の部屋配置
```

### パラメトリックグラマー
```
// パラメータ付きのグラマールール
Grammar: |
  axiom: A(10)
  A(x) -> A(x*2) if x < 100
  A(x) -> B(x) if x >= 100
結果: 条件付きルール展開
```

### 属性値に基づくグラマー
```
// 属性からグラマーをオーバーライド
Grammar: (属性から取得)
PCG_Overridable: Grammar
結果: 動的なグラマー解釈
```

## 実装の詳細

### 入出力ピン
- **入力ピン**: なし（グラマーは設定から取得）
- **出力ピン**:
  - "Out"（Generic）: グラマー解釈の結果データ

### 処理の特徴
- **デバッグノード**: EPCGSettingsType::Debugとして分類
- **文字列処理**: 複数行のグラマー定義をサポート

### グラマーの構文
一般的なL-Systemグラマー構文をサポート：
- **Axiom**: 初期文字列
- **Production Rules**: 置換ルール（A -> B）
- **Terminals**: 終端記号
- **Non-terminals**: 非終端記号
- **Parameters**: パラメトリックルール（オプション）
- **Conditions**: 条件付きルール（オプション）

## パフォーマンス考慮事項

1. **グラマーの複雑度**: 複雑なルールセットは処理時間が増加します
2. **イテレーション数**: 深いイテレーションは指数的に文字列長が増加する可能性があります
3. **文字列サイズ**: 生成される文字列が非常に長くなる場合があります
4. **パーシングコスト**: グラマーの解析にはコストがかかります

## 注意事項

1. **グラマー構文**: 正しいグラマー構文を使用する必要があります
2. **無限展開**: 終端条件のないルールは無限に展開される可能性があります
3. **メモリ制限**: 非常に長い文字列は メモリを大量に消費します
4. **エディタ専用**: デバッグノードとして主にエディタで使用
5. **パフォーマンス**: 複雑なグラマーはパフォーマンスに影響します

## グラマーの基本概念

### Axiom（公理）
グラマー展開の開始点となる初期文字列。

### Production Rules（生成規則）
記号を他の記号列に置き換えるルール。

### Terminals（終端記号）
それ以上展開されない記号。

### Non-terminals（非終端記号）
さらに展開可能な記号。

### Iteration（反復）
ルールを適用する回数。

## グラマーの用途

### 1. プロシージャル構造生成
建物、道路網、ダンジョンレイアウトなどの構造を生成。

### 2. パターン生成
繰り返しパターンや対称パターンの生成。

### 3. 植生配置
木の分岐構造や植物の成長パターンをシミュレート。

### 4. 階層的構造
ネストされた構造や再帰的パターンを生成。

### 5. ルールベース生成
条件付きロジックに基づいた複雑な生成。

## L-Systemの例

### アルゴルの木
```
Grammar: |
  axiom: F
  F -> F[+F]F[-F]F
```

### シェルピンスキーの三角形
```
Grammar: |
  axiom: A
  A -> B-A-B
  B -> A+B+A
```

### ドラゴンカーブ
```
Grammar: |
  axiom: FX
  X -> X+YF+
  Y -> -FX-Y
```

## トラブルシューティング

### グラマーが展開されない
- 構文が正しいか確認
- Axiomが定義されているか確認
- Production Rulesが有効か確認

### 結果が期待と異なる
- ルールの順序を確認
- 終端記号と非終端記号を確認
- イテレーション数を確認

### パフォーマンス問題
- イテレーション数を減らす
- ルールの複雑度を簡素化
- 条件付きルールで展開を制限

## 関連ノード
- **Print String**: テキストメッセージを出力
- **Debug**: データを可視化
- **Execute Blueprint**: カスタムBlueprintロジックを実行
- **String Operations**: 文字列操作（将来的な拡張）

## グラマーシステムとの統合
このノードは、Unreal EngineのPCG Grammarシステムと統合されており、より高度なプロシージャル生成パイプラインの一部として使用できます。

## 実装ファイル
- **ヘッダー**: `Engine/Plugins/PCG/Source/PCG/Public/Elements/Grammar/PCGPrintGrammar.h`
- **実装**: `Engine/Plugins/PCG/Source/PCG/Private/Elements/Grammar/PCGPrintGrammar.cpp`
